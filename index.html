<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>사주 상담 신청 — EVE 사주 분석</title>

<style>
  body { font-family: sans-serif; background:#fafafa; padding:20px; }
  h1 { text-align:center; color:#065f46; }
  .section { background:#fff; padding:20px; border-radius:14px; border:1px solid #e5e7eb; margin-bottom:20px; }
  label { font-weight:600; display:block; margin-bottom:6px; }
  input, select, textarea {
    width:100%; padding:10px; border:1px solid #d1d5db;
    border-radius:8px; margin-bottom:15px;
  }
  button {
    padding:12px 20px; border:none; border-radius:10px;
    font-size:16px; cursor:pointer; font-weight:700;
  }
  button[disabled]{ opacity:.6; cursor:not-allowed; }
  .primary { background:#10b981; color:white; }
  .secondary { background:#e5e7eb; }
  .row { display:flex; gap:12px; flex-wrap:wrap; }
  .half { flex:1; min-width:150px; }
  .muted { font-size:13px;color:#6b7280;margin-top:-10px;margin-bottom:10px; }
  .hidden { display:none; }
</style>
</head>

<body>

<h1>사주 상담 신청</h1>

<form id="consult-form"
      action="https://formspree.io/f/xzznkvag"
      method="POST">

  <!-- Formspree 옵션 -->
  <input type="hidden" name="_subject" value="EVE 사주 상담 신청 접수" />

  <!-- 스팸봇 차단 허니팟 -->
  <input type="text" name="_gotcha" style="display:none" tabindex="-1" autocomplete="off" />

  <!-- ========================= -->
  <!-- 1. 기본 정보 -->
  <!-- ========================= -->
  <div class="section">
    <h2>1. 기본 정보</h2>

    <label>성명</label>
    <input type="text" name="name" required>

    <label>이메일</label>
    <input type="email" name="email" required>

    <div class="row">
      <div class="half">
        <label>성별</label>
        <select name="gender" required>
          <option value="">선택</option>
          <option value="남">남</option>
          <option value="여">여</option>
          <option value="기타/비공개">기타 / 비공개</option>
        </select>
      </div>

      <div class="half">
        <label>생년월일</label>

        <!-- 사용자 입력 -->
        <input
          type="text"
          id="birth_date_ui"
          name="birth_date_ui"
          placeholder="YYYY/MM/DD  예) 1987/03/14"
          inputmode="numeric"
          autocomplete="bday"
          required
        />

        <!-- 서버 전송용 -->
        <input type="hidden" id="birth_date" name="birth_date" />

        <div class="muted">※ 숫자만 입력해도 / 가 자동으로 들어갑니다</div>
      </div>
    </div>

    <div class="row">
      <div class="half">
        <label>출생시간</label>
        <select name="birth_time" id="birth_time">
          <option value="">모름</option>
          <option value="23-01">자(23~01)</option>
          <option value="01-03">축(01~03)</option>
          <option value="03-05">인(03~05)</option>
          <option value="05-07">묘(05~07)</option>
          <option value="07-09">진(07~09)</option>
          <option value="09-11">사(09~11)</option>
          <option value="11-13">오(11~13)</option>
          <option value="13-15">미(13~15)</option>
          <option value="15-17">신(15~17)</option>
          <option value="17-19">유(17~19)</option>
          <option value="19-21">술(19~21)</option>
          <option value="21-23">해(21~23)</option>
        </select>
      </div>
    </div>
  </div>

  <!-- ========================= -->
  <!-- 2. 시주 추정 -->
  <!-- ========================= -->
  <div class="section" id="guess-section">
    <h2>2. 시주 미상일 경우 — 시주 추정 테스트</h2>

    <label><b>1차 질문 — 전반적인 기질</b></label>
    <select id="test_q1" name="test_q1">
      <option value="">선택</option>
      <option value="자">① 분석·계산 빠름 / 야행성 / 집요함</option>
      <option value="묘">② 관계·조율 중심 / 말이 부드러움</option>
      <option value="오">③ 밝고 드러남 / 리더·표현형</option>
      <option value="유">④ 꼼꼼·완성도 / 체면 중시</option>
    </select>

    <label><b>2차 질문 — 인간관계 스타일</b></label>
    <select id="test_q2" name="test_q2">
      <option value="">선택</option>
      <option value="이동형">A. 이동·변화 선호</option>
      <option value="조율형">B. 관계·중재 우선</option>
      <option value="직선형">C. 직설·표현형</option>
      <option value="완성형">D. 완성도·체면 중시</option>
    </select>

    <p class="muted">
      ※ 시주 추정 참고용이며, 실제 해석은 전체 사주 구조 기준으로 판단합니다.
    </p>
  </div>

  <!-- ========================= -->
  <!-- 3. 메모 -->
  <!-- ========================= -->
  <div class="section">
    <h2>3. 추가 메모</h2>
    <textarea name="memo" rows="4" placeholder="상담자에게 전하고 싶은 내용을 자유롭게 적어주세요."></textarea>
  </div>

  <div style="text-align:center;">
    <button class="primary" id="submitBtn" type="submit">분석 요청</button>
    <button class="secondary" type="reset">초기화</button>
  </div>
</form>

<script>
  const form = document.getElementById('consult-form');
  const birthTimeEl = document.getElementById('birth_time');
  const guessSection = document.getElementById('guess-section');
  const q1 = document.getElementById('test_q1');
  const q2 = document.getElementById('test_q2');
  const submitBtn = document.getElementById('submitBtn');

  // 시주 추정 토글
  function syncGuessUI() {
    if (!birthTimeEl.value) {
      guessSection.classList.remove('hidden');
      q1.required = true;
      q2.required = true;
    } else {
      guessSection.classList.add('hidden');
      q1.required = false;
      q2.required = false;
      q1.value = "";
      q2.value = "";
    }
  }
  syncGuessUI();
  birthTimeEl.addEventListener('change', syncGuessUI);

  // 생년월일 자동 슬래시 + ISO 변환
  const birthUI = document.getElementById('birth_date_ui');
  const birthHidden = document.getElementById('birth_date');

  birthUI.addEventListener('input', () => {
    const digits = birthUI.value.replace(/\D/g,'').slice(0,8);
    const y = digits.slice(0,4);
    const m = digits.slice(4,6);
    const d = digits.slice(6,8);

    let out = y;
    if (m) out += '/' + m;
    if (d) out += '/' + d;
    birthUI.value = out;

    birthHidden.value = (y && m && d) ? `${y}-${m}-${d}` : '';
  });

  // 제출 제어
  form.addEventListener('submit', (e) => {
    if (!birthHidden.value) {
      e.preventDefault();
      birthUI.setCustomValidity('생년월일을 YYYY/MM/DD 형식으로 입력하세요.');
      birthUI.reportValidity();
      submitBtn.disabled = false;
      submitBtn.textContent = "분석 요청";
      return;
    }
    submitBtn.disabled = true;
    submitBtn.textContent = "전송 중...";
  });

  form.addEventListener('reset', () => {
    setTimeout(() => {
      submitBtn.disabled = false;
      submitBtn.textContent = "분석 요청";
      syncGuessUI();
    }, 0);
  });
</script>

</body>
</html>

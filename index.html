<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>EVE Saju Analysis</title>

<style>
  body { font-family: sans-serif; background:#fafafa; padding:20px; }
  h1 { text-align:center; color:#065f46; margin-bottom:6px; }
  .subtitle { text-align:center; color:#6b7280; margin-top:0; margin-bottom:14px; font-size:14px; }
  .section { background:#fff; padding:20px; border-radius:14px; border:1px solid #e5e7eb; margin-bottom:20px; }
  label { font-weight:600; display:block; margin-bottom:6px; }
  input, select, textarea {
    width:100%; padding:10px; border:1px solid #d1d5db;
    border-radius:8px; margin-bottom:15px;
  }
  textarea { min-height:110px; resize:vertical; }
  button {
    padding:12px 20px; border:none; border-radius:10px;
    font-size:16px; cursor:pointer; font-weight:700;
  }
  button[disabled]{ opacity:.6; cursor:not-allowed; }
  .primary { background:#10b981; color:white; }
  .secondary { background:#e5e7eb; color:#111827; }

  .row { display:flex; gap:12px; }
  .col { flex:1; }
  @media (max-width: 720px){
    .row { flex-direction:column; }
  }

  .muted { color:#6b7280; font-size:13px; margin-top:-8px; margin-bottom:12px; }
  .pill { display:inline-block; padding:2px 8px; border-radius:999px; background:#ecfdf5; color:#065f46; font-size:12px; font-weight:700; border:1px solid #a7f3d0; }
  .notice { background:#f9fafb; border:1px dashed #d1d5db; padding:12px; border-radius:12px; color:#374151; font-size:13px; }
  .radio-wrap { border:1px solid #e5e7eb; padding:12px; border-radius:12px; margin-bottom:12px; }
  .radio-q { font-weight:700; margin-bottom:10px; }
  .radio-opt { display:flex; gap:8px; align-items:flex-start; margin:8px 0; }
  .radio-opt input { width:auto; margin:2px 0 0 0; }
  .hidden { display:none; }

  .inline { display:flex; gap:10px; align-items:center; flex-wrap:wrap; }
  .inline input[type="checkbox"]{ width:auto; margin:0; }
  .paybox { border:1px solid #e5e7eb; border-radius:12px; padding:12px; background:#fff; }

  /* KR/EN toggle */
  .langbar{display:flex; justify-content:center; gap:8px; margin:10px 0 18px;}
  .langbtn{padding:8px 12px; border-radius:999px; border:1px solid #d1d5db; background:#fff; cursor:pointer; font-weight:800;}
  .langbtn.active{border-color:#10b981; color:#065f46; background:#ecfdf5;}
</style>
</head>

<body>

<h1 data-i18n="title">사주 상담 신청 — EVE 사주 분석</h1>
<p class="subtitle" data-i18n="subtitle">— (당신에게 주어진 길) —</p>

<div class="langbar">
  <button type="button" class="langbtn active" id="btnKR" aria-pressed="true">한국어</button>
  <button type="button" class="langbtn" id="btnEN" aria-pressed="false">English</button>
</div>

<form
  id="consult-form"
  action="https://formspree.io/f/xjkndyrq"
  method="POST"
  accept-charset="UTF-8">


  <div class="section">
    <div class="inline" style="justify-content:space-between;">
      <div class="pill" data-i18n="pill_lang">Korean/English</div>
      <div class="muted" style="margin:0;" data-i18n="pill_hint">Same layout • Text switches only</div>
    </div>

    <label for="name" data-i18n="label_name">성함</label>
    <input id="name" name="name" type="text" data-i18n-ph="ph_name" placeholder="이름" required />

    <div class="row">
      <div class="col">
        <label for="email" data-i18n="label_email">이메일</label>
        <input id="email" name="email" type="email" data-i18n-ph="ph_email" placeholder="you@example.com" required />
      </div>
      <div class="col">
        <label for="phone" data-i18n="label_phone">전화번호(선택)</label>
        <input id="phone" name="phone" type="text" data-i18n-ph="ph_phone" placeholder="+1 (xxx) xxx-xxxx" />
      </div>
    </div>

    <div class="row">
      <div class="col">
        <label for="birth_date" data-i18n="label_birth_date">생년월일</label>
<input
  id="birth_date"
  name="birth_date"
  type="text"
  placeholder="YYYY-MM-DD"
  inputmode="numeric"
  autocomplete="bday"
  maxlength="10"
  pattern="\d{4}-\d{2}-\d{2}"
  required
/>

      </div>
      <div class="col">
        <label for="birth_time" data-i18n="label_birth_time">출생 시간</label>
        <select id="birth_time" name="birth_time" required>
          <option value="" data-i18n="opt_select">선택…</option>
          <option value="unknown" data-i18n="opt_unknown">시간 모름</option>
          <option value="00:00">00:00</option><option value="01:00">01:00</option><option value="02:00">02:00</option>
          <option value="03:00">03:00</option><option value="04:00">04:00</option><option value="05:00">05:00</option>
          <option value="06:00">06:00</option><option value="07:00">07:00</option><option value="08:00">08:00</option>
          <option value="09:00">09:00</option><option value="10:00">10:00</option><option value="11:00">11:00</option>
          <option value="12:00">12:00</option><option value="13:00">13:00</option><option value="14:00">14:00</option>
          <option value="15:00">15:00</option><option value="16:00">16:00</option><option value="17:00">17:00</option>
          <option value="18:00">18:00</option><option value="19:00">19:00</option><option value="20:00">20:00</option>
          <option value="21:00">21:00</option><option value="22:00">22:00</option><option value="23:00">23:00</option>
        </select>
        <p class="muted" data-i18n="hint_time_unknown">
          시간 모름을 선택하면 아래 시주 추정 문항 10개에 반드시 답해야 제출됩니다.
        </p>
      </div>
    </div>

    <label for="birth_place" data-i18n="label_birth_place">출생지(도시/국가)</label>
    <input id="birth_place" name="birth_place" type="text" data-i18n-ph="ph_birth_place" placeholder="예: Seoul, South Korea" required />

    <label for="gender" data-i18n="label_gender">성별</label>
    <select id="gender" name="gender" required>
      <option value="" data-i18n="opt_select">선택…</option>
      <option value="female" data-i18n="opt_female">여성</option>
      <option value="male" data-i18n="opt_male">남성</option>
      <option value="other" data-i18n="opt_other">기타/응답 안함</option>
    </select>
  </div>

  <!-- Birth time estimation (required when Unknown) -->
  <div class="section hidden" id="guess-section">
    <div class="notice" style="margin-bottom:14px;">
      <b data-i18n="guess_notice_bold">시간 모름:</b>
      <span data-i18n="guess_notice_text">아래 10문항은 시주(자·묘·오·유 성향) 추정에 사용됩니다. 모두 답해주세요.</span>
    </div>

    <!-- Q1 -->
    <div class="radio-wrap" data-required="1">
      <div class="radio-q" data-i18n="q1">1) 내 인생의 기본 모드(디폴트)는…</div>
      <label class="radio-opt"><input type="radio" name="g_q1" value="zi" /><span data-i18n="q1_a">깊은 집중/전략/고독, 밤에 강함</span></label>
      <label class="radio-opt"><input type="radio" name="g_q1" value="mao" /><span data-i18n="q1_b">부드럽지만 꾸준한 성장, 루틴/정돈</span></label>
      <label class="radio-opt"><input type="radio" name="g_q1" value="wu" /><span data-i18n="q1_c">대담한 가시성/리더십, 속전속결</span></label>
      <label class="radio-opt"><input type="radio" name="g_q1" value="you" /><span data-i18n="q1_d">날카로운 판단/기준, ‘정확·깔끔’</span></label>
    </div>

    <!-- Q2 -->
    <div class="radio-wrap" data-required="1">
      <div class="radio-q" data-i18n="q2">2) 생산성이 가장 잘 나오는 시간대는…</div>
      <label class="radio-opt"><input type="radio" name="g_q2" value="zi" /><span data-i18n="q2_a">심야/모두 잠든 뒤</span></label>
      <label class="radio-opt"><input type="radio" name="g_q2" value="mao" /><span data-i18n="q2_b">이른 아침/조용한 시작</span></label>
      <label class="radio-opt"><input type="radio" name="g_q2" value="wu" /><span data-i18n="q2_c">한낮/현장이 뜨거울 때</span></label>
      <label class="radio-opt"><input type="radio" name="g_q2" value="you" /><span data-i18n="q2_d">저녁/정리·마감 시간</span></label>
    </div>

    <!-- Q3 -->
    <div class="radio-wrap" data-required="1">
      <div class="radio-q" data-i18n="q3">3) 스트레스를 받으면 나는…</div>
      <label class="radio-opt"><input type="radio" name="g_q3" value="zi" /><span data-i18n="q3_a">숨고 분석한다(비공개)</span></label>
      <label class="radio-opt"><input type="radio" name="g_q3" value="mao" /><span data-i18n="q3_b">민감해지고 평화를 찾는다(충돌 회피)</span></label>
      <label class="radio-opt"><input type="radio" name="g_q3" value="wu" /><span data-i18n="q3_c">바로 부딪히고 ‘지금 해결’</span></label>
      <label class="radio-opt"><input type="radio" name="g_q3" value="you" /><span data-i18n="q3_d">비판/수정/규칙을 더 엄격히</span></label>
    </div>

    <!-- Q4 -->
    <div class="radio-wrap" data-required="1">
      <div class="radio-q" data-i18n="q4">4) 인간관계에서 나는…</div>
      <label class="radio-opt"><input type="radio" name="g_q4" value="zi" /><span data-i18n="q4_a">적지만 깊게, 충성/의리</span></label>
      <label class="radio-opt"><input type="radio" name="g_q4" value="mao" /><span data-i18n="q4_b">따뜻하게 보살피고 말에 조심</span></label>
      <label class="radio-opt"><input type="radio" name="g_q4" value="wu" /><span data-i18n="q4_c">열정/직진, 에너지와 속도</span></label>
      <label class="radio-opt"><input type="radio" name="g_q4" value="you" /><span data-i18n="q4_d">기준이 높고 ‘예의/존중’ 중요</span></label>
    </div>

    <!-- Q5 -->
    <div class="radio-wrap" data-required="1">
      <div class="radio-q" data-i18n="q5">5) 돈에 대한 내 스타일은…</div>
      <label class="radio-opt"><input type="radio" name="g_q5" value="zi" /><span data-i18n="q5_a">정보/타이밍 기반 장기전</span></label>
      <label class="radio-opt"><input type="radio" name="g_q5" value="mao" /><span data-i18n="q5_b">저축/안정, 점진적 성장</span></label>
      <label class="radio-opt"><input type="radio" name="g_q5" value="wu" /><span data-i18n="q5_c">크게 베팅, 기회 오면 빠르게</span></label>
      <label class="radio-opt"><input type="radio" name="g_q5" value="you" /><span data-i18n="q5_d">예산·정산 철저, 낭비 싫음</span></label>
    </div>

    <!-- Q6 -->
    <div class="radio-wrap" data-required="1">
      <div class="radio-q" data-i18n="q6">6) 내 집/책상 상태는 보통…</div>
      <label class="radio-opt"><input type="radio" name="g_q6" value="zi" /><span data-i18n="q6_a">프라이빗, 내 셋업 건드리면 싫음</span></label>
      <label class="radio-opt"><input type="radio" name="g_q6" value="mao" /><span data-i18n="q6_b">아늑·편안, 분위기 중시</span></label>
      <label class="radio-opt"><input type="radio" name="g_q6" value="wu" /><span data-i18n="q6_c">바쁘고 역동적, 도구가 늘 준비됨</span></label>
      <label class="radio-opt"><input type="radio" name="g_q6" value="you" /><span data-i18n="q6_d">정리/라벨/미감, ‘정돈’이 기본</span></label>
    </div>

    <!-- Q7 -->
    <div class="radio-wrap" data-required="1">
      <div class="radio-q" data-i18n="q7">7) 새로 배울 때 나는…</div>
      <label class="radio-opt"><input type="radio" name="g_q7" value="zi" /><span data-i18n="q7_a">혼자 깊게 파고 이론부터 마스터</span></label>
      <label class="radio-opt"><input type="radio" name="g_q7" value="mao" /><span data-i18n="q7_b">단계적으로 반복하며 익힘</span></label>
      <label class="radio-opt"><input type="radio" name="g_q7" value="wu" /><span data-i18n="q7_c">손으로 부딪히며 빠른 피드백</span></label>
      <label class="radio-opt"><input type="radio" name="g_q7" value="you" /><span data-i18n="q7_d">표준/베스트프랙티스, ‘정석’ 선호</span></label>
    </div>

    <!-- Q8 -->
    <div class="radio-wrap" data-required="1">
      <div class="radio-q" data-i18n="q8">8) 사람들이 나를 흔히 이렇게 말한다…</div>
      <label class="radio-opt"><input type="radio" name="g_q8" value="zi" /><span data-i18n="q8_a">신비/사색/속을 잘 안 보임</span></label>
      <label class="radio-opt"><input type="radio" name="g_q8" value="mao" /><span data-i18n="q8_b">친절/섬세/감정이 세밀함</span></label>
      <label class="radio-opt"><input type="radio" name="g_q8" value="wu" /><span data-i18n="q8_c">자신감/에너지/강한 추진</span></label>
      <label class="radio-opt"><input type="radio" name="g_q8" value="you" /><span data-i18n="q8_d">까다로움/정확/기준이 높음</span></label>
    </div>

    <!-- Q9 -->
    <div class="radio-wrap" data-required="1">
      <div class="radio-q" data-i18n="q9">9) 내 ‘승리 조건’은 보통…</div>
      <label class="radio-opt"><input type="radio" name="g_q9" value="zi" /><span data-i18n="q9_a">정보·타이밍을 쥐는 것</span></label>
      <label class="radio-opt"><input type="radio" name="g_q9" value="mao" /><span data-i18n="q9_b">조화 유지 + 꾸준한 성장</span></label>
      <label class="radio-opt"><input type="radio" name="g_q9" value="wu" /><span data-i18n="q9_c">열기·주목·결단의 실행</span></label>
      <label class="radio-opt"><input type="radio" name="g_q9" value="you" /><span data-i18n="q9_d">정교화·최적화·완성도</span></label>
    </div>

    <!-- Q10 -->
    <div class="radio-wrap" data-required="1">
      <div class="radio-q" data-i18n="q10">10) 하나만 고르라면 나는…</div>
      <label class="radio-opt"><input type="radio" name="g_q10" value="zi" /><span data-i18n="q10_a">겨울/자정/물의 기운</span></label>
      <label class="radio-opt"><input type="radio" name="g_q10" value="mao" /><span data-i18n="q10_b">봄/새벽/나무의 기운</span></label>
      <label class="radio-opt"><input type="radio" name="g_q10" value="wu" /><span data-i18n="q10_c">여름/정오/불의 기운</span></label>
      <label class="radio-opt"><input type="radio" name="g_q10" value="you" /><span data-i18n="q10_d">가을/해질녘/금속의 기운</span></label>
    </div>
  </div>

  <div class="section">
    <label for="topic" data-i18n="label_topic">어떤 주제를 중심으로 볼까요?</label>
    <select id="topic" name="topic" required>
      <option value="" data-i18n="opt_select">선택…</option>
      <option value="overall" data-i18n="opt_overall">종합</option>
      <option value="career" data-i18n="opt_career">직업/사업</option>
      <option value="money" data-i18n="opt_money">재물</option>
      <option value="relationship" data-i18n="opt_relationship">연애/결혼</option>
      <option value="health" data-i18n="opt_health">건강/기운</option>
      <option value="timing" data-i18n="opt_timing">시기/운</option>
    </select>

    <label for="message" data-i18n="label_message">질문/배경(가능한 자세히)</label>
    <textarea id="message" name="message" data-i18n-ph="ph_message"
      placeholder="현재 상황, 고민, 확인하고 싶은 포인트를 적어주세요." required></textarea>
  </div>

  <!-- Payment / Confirmation -->
  <div class="section">
    <div class="paybox" id="paid-box">
      <div style="font-weight:800; margin-bottom:6px;" data-i18n="pay_title">결제</div>
      <div class="muted" style="margin:0 0 12px 0;" data-i18n="pay_desc">
        결제 완료 후 체크박스를 선택해야 제출 버튼이 활성화됩니다.
      </div>

      <button type="button" id="btnPay" class="secondary" data-i18n="btn_pay">결제 링크 열기</button>

      <div class="inline" style="margin-top:12px;">
        <input type="checkbox" id="chkPaidConfirm" />
        <label for="chkPaidConfirm" style="margin:0; font-weight:700;" data-i18n="chk_paid">결제를 완료했습니다.</label>
      </div>

      <input type="hidden" id="paid_confirm" name="paid_confirm" value="no" />
    </div>
  </div>

  <div style="text-align:center;">
    <button class="primary" id="submitBtn" type="submit" disabled data-i18n="btn_submit">분석 요청</button>
    <button class="secondary" type="reset" data-i18n="btn_reset">초기화</button>
  </div>

</form>

<script>
  // ✅ Replace with your LIVE Stripe Payment Link
const PAYMENT_LINK_KR = "https://buy.stripe.com/5kQ4gBcfz0HA8qu6QhcjS05";
const PAYMENT_LINK_EN = "https://buy.stripe.com/bJe7sN0wR8a26im7UlcjS06";

  const form = document.getElementById('consult-form');
  const birthTime = document.getElementById('birth_time');
  const guess = document.getElementById('guess-section');
  const submitBtn = document.getElementById('submitBtn');

  const chkPaid = document.getElementById('chkPaidConfirm');
  const paidHidden = document.getElementById('paid_confirm');
  const btnPay = document.getElementById('btnPay');

  // ---------- i18n ----------
  const I18N = {
    kr: {
      title: "사주 상담 신청 — EVE 사주 분석",
      subtitle: "— (당신에게 주어진 길) —",
      pill_lang: "Korean/English",
      pill_hint: "같은 형식 • 텍스트만 전환",

      label_name: "성함", ph_name: "이름",
      label_email: "이메일", ph_email: "you@example.com",
      label_phone: "전화번호(선택)", ph_phone: "+1 (xxx) xxx-xxxx",

      label_birth_date: "생년월일",
      label_birth_time: "출생 시간",
      opt_select: "선택…",
      opt_unknown: "시간 모름",
      hint_time_unknown: "시간 모름을 선택하면 아래 시주 추정 문항 10개에 반드시 답해야 제출됩니다.",

      label_birth_place: "출생지(도시/국가)",
      ph_birth_place: "예: Seoul, South Korea",

      label_gender: "성별",
      opt_female: "여성",
      opt_male: "남성",
      opt_other: "기타/응답 안함",

      guess_notice_bold: "시간 모름:",
      guess_notice_text: "아래 10문항은 시주(자·묘·오·유 성향) 추정에 사용됩니다. 모두 답해주세요.",

      q1:"1) 내 인생의 기본 모드(디폴트)는…",
      q1_a:"깊은 집중/전략/고독, 밤에 강함", q1_b:"부드럽지만 꾸준한 성장, 루틴/정돈", q1_c:"대담한 가시성/리더십, 속전속결", q1_d:"날카로운 판단/기준, ‘정확·깔끔’",
      q2:"2) 생산성이 가장 잘 나오는 시간대는…",
      q2_a:"심야/모두 잠든 뒤", q2_b:"이른 아침/조용한 시작", q2_c:"한낮/현장이 뜨거울 때", q2_d:"저녁/정리·마감 시간",
      q3:"3) 스트레스를 받으면 나는…",
      q3_a:"숨고 분석한다(비공개)", q3_b:"민감해지고 평화를 찾는다(충돌 회피)", q3_c:"바로 부딪히고 ‘지금 해결’", q3_d:"비판/수정/규칙을 더 엄격히",
      q4:"4) 인간관계에서 나는…",
      q4_a:"적지만 깊게, 충성/의리", q4_b:"따뜻하게 보살피고 말에 조심", q4_c:"열정/직진, 에너지와 속도", q4_d:"기준이 높고 ‘예의/존중’ 중요",
      q5:"5) 돈에 대한 내 스타일은…",
      q5_a:"정보/타이밍 기반 장기전", q5_b:"저축/안정, 점진적 성장", q5_c:"크게 베팅, 기회 오면 빠르게", q5_d:"예산·정산 철저, 낭비 싫음",
      q6:"6) 내 집/책상 상태는 보통…",
      q6_a:"프라이빗, 내 셋업 건드리면 싫음", q6_b:"아늑·편안, 분위기 중시", q6_c:"바쁘고 역동적, 도구가 늘 준비됨", q6_d:"정리/라벨/미감, ‘정돈’이 기본",
      q7:"7) 새로 배울 때 나는…",
      q7_a:"혼자 깊게 파고 이론부터 마스터", q7_b:"단계적으로 반복하며 익힘", q7_c:"손으로 부딪히며 빠른 피드백", q7_d:"표준/베스트프랙티스, ‘정석’ 선호",
      q8:"8) 사람들이 나를 흔히 이렇게 말한다…",
      q8_a:"신비/사색/속을 잘 안 보임", q8_b:"친절/섬세/감정이 세밀함", q8_c:"자신감/에너지/강한 추진", q8_d:"까다로움/정확/기준이 높음",
      q9:"9) 내 ‘승리 조건’은 보통…",
      q9_a:"정보·타이밍을 쥐는 것", q9_b:"조화 유지 + 꾸준한 성장", q9_c:"열기·주목·결단의 실행", q9_d:"정교화·최적화·완성도",
      q10:"10) 하나만 고르라면 나는…",
      q10_a:"겨울/자정/물의 기운", q10_b:"봄/새벽/나무의 기운", q10_c:"여름/정오/불의 기운", q10_d:"가을/해질녘/금속의 기운",

      label_topic: "어떤 주제를 중심으로 볼까요?",
      opt_overall: "종합",
      opt_career: "직업/사업",
      opt_money: "재물",
      opt_relationship: "연애/결혼",
      opt_health: "건강/기운",
      opt_timing: "시기/운",

      label_message: "질문/배경(가능한 자세히)",
      ph_message: "현재 상황, 고민, 확인하고 싶은 포인트를 적어주세요.",

      pay_title: "결제",
      pay_desc: "결제 완료 후 체크박스를 선택해야 제출 버튼이 활성화됩니다.",
      btn_pay: "결제 링크 열기",
      chk_paid: "결제를 완료했습니다.",

      btn_submit: "분석 요청",
      btn_reset: "초기화",

      alert_need_guess: "출생 시간이 ‘시간 모름’입니다. 시주 추정 문항 10개를 모두 답한 후 제출해 주세요.",
      alert_need_pay: "결제를 완료한 뒤 확인 체크를 해주세요.",
      alert_need_link: "PAYMENT_LINK에 Stripe 결제 링크를 먼저 붙여넣어 주세요."
    },

    en: {
      title: "Saju Consultation Request — EVE Saju Analysis",
      subtitle: "— (The Path Given to You) —",
      pill_lang: "Korean/English",
      pill_hint: "Same layout • Text switches only",

      label_name: "Full Name", ph_name: "Your name",
      label_email: "Email", ph_email: "you@example.com",
      label_phone: "Phone (optional)", ph_phone: "+1 (xxx) xxx-xxxx",

      label_birth_date: "Birth Date",
      label_birth_time: "Birth Time",
      opt_select: "Select…",
      opt_unknown: "Unknown",
      hint_time_unknown: "If you choose Unknown, you must answer all 10 Birth Time Estimation questions below.",

      label_birth_place: "Birth Place (City / Country)",
      ph_birth_place: "e.g., Seoul, South Korea",

      label_gender: "Gender",
      opt_female: "Female",
      opt_male: "Male",
      opt_other: "Other / Prefer not to say",

      guess_notice_bold: "Birth time unknown:",
      guess_notice_text: "These 10 questions help estimate your likely time pillar archetype (Zi / Mao / Wu / You). Please answer all.",

      q1:"1) Your strongest “default mode” in life is…",
      q1_a:"Deep focus, strategy, solitude; strong at night", q1_b:"Gentle but persistent growth; steady routines", q1_c:"Bold visibility/leadership; fast decisions", q1_d:"Sharp standards; precise and clean",
      q2:"2) Your most common productivity window is…",
      q2_a:"Late night / after everyone sleeps", q2_b:"Early morning / calm start", q2_c:"Midday / when things are moving", q2_d:"Evening / when you finalize and tidy up",
      q3:"3) Under stress, you tend to…",
      q3_a:"Withdraw and analyze privately", q3_b:"Get sensitive; seek peace; avoid harsh conflict", q3_c:"Confront fast; “solve it now”", q3_d:"Critique, correct, tighten rules",
      q4:"4) In relationships, your pattern is closer to…",
      q4_a:"Few but deep; loyalty over quantity", q4_b:"Warm and supportive; careful with words", q4_c:"Passionate and direct; needs momentum", q4_d:"High standards; respect-based; dislikes sloppy behavior",
      q5:"5) Your money style is…",
      q5_a:"Strategic investing; long game; timing advantage", q5_b:"Steady savings; gradual growth; low risk", q5_c:"Big swings; bold bets; fast opportunities", q5_d:"Strict budgeting; hates waste",
      q6:"6) Your home/desk is usually…",
      q6_a:"Private; don’t touch my setup", q6_b:"Cozy and calm vibe", q6_c:"Busy, active; tools ready to move", q6_d:"Organized; labeled; aesthetically precise",
      q7:"7) When learning something new, you prefer…",
      q7_a:"Deep dive alone; master theory first", q7_b:"Step-by-step with repetition", q7_c:"Hands-on; trial and error; fast feedback", q7_d:"Best practices and standards; do it “right”",
      q8:"8) People often describe you as…",
      q8_a:"Mysterious / thoughtful / hard to read", q8_b:"Kind / elegant / emotionally tuned-in", q8_c:"Confident / energetic / intense", q8_d:"Sharp / picky / very accurate",
      q9:"9) Your “winning condition” is usually…",
      q9_a:"Control information and timing", q9_b:"Maintain harmony and grow steadily", q9_c:"Create heat, attention, decisive action", q9_d:"Refine, optimize, and perfect systems",
      q10:"10) If you had to pick one, you relate more to…",
      q10_a:"Winter / midnight / water vibe", q10_b:"Spring / dawn / wood vibe", q10_c:"Summer / noon / fire vibe", q10_d:"Autumn / sunset / metal vibe",

      label_topic: "What would you like to focus on?",
      opt_overall: "Overall reading",
      opt_career: "Career / Business",
      opt_money: "Money / Wealth",
      opt_relationship: "Relationship / Marriage",
      opt_health: "Health / Energy balance",
      opt_timing: "Timing / Luck cycles",

      label_message: "Your question / background (as detailed as possible)",
      ph_message: "Tell us what's happening, what you're deciding, and what you want to confirm.",

      pay_title: "Payment",
      pay_desc: "Complete payment first, then check the box to enable submission.",
      btn_pay: "Open Payment Link",
      chk_paid: "I have completed the payment.",

      btn_submit: "Request Analysis",
      btn_reset: "Reset",

      alert_need_guess: "Birth time is set to Unknown. Please answer all 10 Birth Time Estimation questions before submitting.",
      alert_need_pay: "Please complete payment and check the confirmation box to submit.",
      alert_need_link: "Please paste your Stripe Payment Link into PAYMENT_LINK first."
    }
  };

  let LANG = "kr";
  function applyI18n(lang){
    LANG = lang;
    const dict = I18N[lang];

    document.querySelectorAll("[data-i18n]").forEach(el => {
      const key = el.getAttribute("data-i18n");
      if (dict[key] != null) el.textContent = dict[key];
    });

    document.querySelectorAll("[data-i18n-ph]").forEach(el => {
      const key = el.getAttribute("data-i18n-ph");
      if (dict[key] != null) el.setAttribute("placeholder", dict[key]);
    });

    document.documentElement.lang = (lang === "kr") ? "ko" : "en";
  }
  window.t = (key) => (I18N[LANG] && I18N[LANG][key]) ? I18N[LANG][key] : key;

  // toggle buttons
  const btnKR = document.getElementById("btnKR");
  const btnEN = document.getElementById("btnEN");
  function setActive(btnOn, btnOff){
    btnOn.classList.add("active");
    btnOff.classList.remove("active");
    btnOn.setAttribute("aria-pressed","true");
    btnOff.setAttribute("aria-pressed","false");
  }
  btnKR.addEventListener("click", () => { applyI18n("kr"); setActive(btnKR, btnEN); });
  btnEN.addEventListener("click", () => { applyI18n("en"); setActive(btnEN, btnKR); });

  // ---------- Payment checkbox gating ----------
  function setSubmitEnabled() {
    const paidOk = chkPaid.checked;
    submitBtn.disabled = !paidOk;
    paidHidden.value = paidOk ? "yes" : "no";
  }

  // ---------- Unknown time => require all 10 answers ----------
  function setGuessRequired(isRequired) {
    const wraps = guess.querySelectorAll('.radio-wrap[data-required="1"]');
    wraps.forEach(wrap => {
      const radios = wrap.querySelectorAll('input[type="radio"]');
      radios.forEach(r => r.required = isRequired);
    });
  }

  function handleBirthTimeUI() {
    const unknown = (birthTime.value === "unknown");
    guess.classList.toggle('hidden', !unknown);
    setGuessRequired(unknown);
  }

  function allGuessAnswered() {
    const groups = ["g_q1","g_q2","g_q3","g_q4","g_q5","g_q6","g_q7","g_q8","g_q9","g_q10"];
    for (const g of groups) {
      const picked = form.querySelector(`input[name="${g}"]:checked`);
      if (!picked) return false;
    }
    return true;
  }

  btnPay.addEventListener('click', () => {
  const isEN = (LANG === "en");
  const baseLink = isEN ? PAYMENT_LINK_EN : PAYMENT_LINK_KR;

  if (!baseLink || baseLink.includes("PASTE_")) {
    alert(window.t("alert_need_link"));
    return;
  }

  const locale = isEN ? "en" : "ko";
  const sep = baseLink.includes("?") ? "&" : "?";
  const payUrl = `${baseLink}${sep}locale=${encodeURIComponent(locale)}`;

  window.open(payUrl, "_blank", "noopener,noreferrer");
});


  chkPaid.addEventListener('change', setSubmitEnabled);
  birthTime.addEventListener('change', handleBirthTimeUI);

  form.addEventListener('reset', () => {
    setTimeout(() => {
      chkPaid.checked = false;
      setSubmitEnabled();
      handleBirthTimeUI();
    }, 0);
  });

  form.addEventListener('submit', (e) => {
    if (birthTime.value === "unknown" && !allGuessAnswered()) {
      e.preventDefault();
      alert(window.t("alert_need_guess"));
      guess.scrollIntoView({ behavior: "smooth", block: "start" });
      return;
    }

    if (!chkPaid.checked) {
      e.preventDefault();
      alert(window.t("alert_need_pay"));
      return;
    }

    // If action is "#", just show payload in console (replace with Formspree/back-end)
    if (form.getAttribute("action") === "#") {
      e.preventDefault();
      const data = new FormData(form);
      const obj = {};
      data.forEach((v,k)=>obj[k]=v);
      console.log("Form payload:", obj);
      alert("OK. Payload printed to console. Connect Formspree/back-end to submit.");
    }
  });
  // ===== Birth date auto-format (YYYY-MM-DD) =====
  const birthDateInput = document.getElementById("birth_date");

  function formatYYYYMMDD(value) {
    const digits = value.replace(/\D/g, "").slice(0, 8);
    const y = digits.slice(0, 4);
    const m = digits.slice(4, 6);
    const d = digits.slice(6, 8);

    if (digits.length <= 4) return y;
    if (digits.length <= 6) return `${y}-${m}`;
    return `${y}-${m}-${d}`;
  }

  if (birthDateInput) {
    birthDateInput.addEventListener("input", (e) => {
      const before = e.target.value;
      const start = e.target.selectionStart || before.length;

      e.target.value = formatYYYYMMDD(e.target.value);

      const after = e.target.value;
      const diff = after.length - before.length;
      const pos = Math.max(0, start + diff);
      e.target.setSelectionRange(pos, pos);
    });
  }

  // init
  applyI18n(LANG);
  setSubmitEnabled();
  handleBirthTimeUI();
</script>

</body>
</html>
